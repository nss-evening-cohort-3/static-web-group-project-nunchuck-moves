YUI.add("hermes-template-photo-sidebar-toggle",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){return"Close"}function c(e,t){return"Open"}function h(e,t){return"fullscreen"}function p(e,t){return"&#10529;"}function d(e,t){return"&#10530;"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<a href="',(o=n.url)?o=o.call(t,{hash:{},data:i}):(o=t.url,o=typeof o===u?o.apply(t):o),s+=a(o)+'" class="toggle" data-track="lightbox',o=n["if"].call(t,t.isRealFullscreen,{hash:{},inverse:f.program(3,c,i),fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+='Click">\n	<span class="toggle-icon hide-text ',o=n["if"].call(t,t.isRealFullscreen,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+='">',o=n["if"].call(t,t.isRealFullscreen,{hash:{},inverse:f.program(9,d,i),fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;return s+="</span>\n</a>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-sidebar-toggle",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-sidebar-toggle-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(t){return this.photoId=t.photoId,this.realFullscreen=!!t.realFullscreen,this.contextData=e.clone(t.context,!0),this},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModel("photo-models",this.photoId).then(function(e){e&&t.set("photo",e)})),this.contextData&&this.contextData.modelName&&this.contextData.params&&n.push(this.appContext.getModel(this.contextData.modelName,this.contextData.params).then(function(e){e&&t.set("contextModel",e)}).then(null,function(){return"whatever"})),e.Promise.all(n)},getLightboxURL:function(){var t,n=this.get("photo"),r="";return this.get("contextModel")&&(r=this.get("contextModel").getValue("urlSuffix")),t=n?e.URLHelper.getPhotoPage({photoId:n.getValue("id"),pathAlias:n.getValue("owner").getValue("pathAlias"),contextSuffix:r,lightbox:!this.appContext.experiments.fullscreen.getMode()}):"#",t},buildContainer:function(){var e,t=this.appContext.experiments.fullscreen.getMode();return e=this.templates("photo-sidebar-toggle")({isRealFullscreen:t,url:this.getLightboxURL()}),this.get("container").addClass("show"),this.setContainerHTML(e),this},activate:function(){var t=this,n=this.appContext.getViewer().prefs.keyboardShortcutsEnabled;return n&&(this.attachKeyEvent("down:76",function(n){n.preventDefault(),e.rapidTracker.beacon(t.name,"lightbox"+(t.appContext.experiments.fullscreen.getMode()?"Close":"Open")+"KeyPress"),t.appContext.flapp.navigate(t.getLightboxURL())}),this.appContext.flipper.isFlipped("enable-scrappy-photo-page")&&this.attachKeyEvent("up:27",function(n){t.appContext.experiments.fullscreen.getMode()&&(n.preventDefault(),e.rapidTracker.beacon(t.name,"lightboxCloseEscKeyPress"),t.appContext.flapp.navigate(t.getLightboxURL()))})),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-sidebar-toggle","promise","photo-sidebar-toggle-css"],optional:[]});
